<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Profile Icon Trigger (outside navbar, top right corner) -->
  <div id="profile-icon-container" style="position:fixed; top:18px; right:32px; z-index:1001;">
    <a href="#" id="profile-icon-link" style="padding:0; display:flex; align-items:center;">
      <img src="assets/profile-custom.png" alt="Profile Icon" class="profile-icon" id="nav-profile-icon">
    </a>
  </div>
  <!-- Profile Popup Card (always below icon, styled like reference) -->
  <div id="profile-modal" style="display:none; position:fixed; top:90px; right:32px; background:#23232b; color:#fff; min-width:340px; max-width:90vw; box-shadow:0 8px 32px rgba(80,80,180,0.18); border-radius:18px; padding:2rem 2.5rem 1.5rem 2.5rem; z-index:1002;">
    <div id="profile-view" style="display:flex; flex-direction:column; align-items:center;">
      <img src="assets/profile-custom.png" alt="Profile" style="width:80px; height:80px; border-radius:50%; margin-bottom:1rem; box-shadow:0 2px 8px rgba(80,80,180,0.18); border:3px solid #222; background:#fff; object-fit:cover;">
      <div style="font-weight:700; font-size:1.25rem; margin-bottom:0.3rem;" id="profile-name-view">dhyaneswar</div>
      <div style="font-size:1rem; margin-bottom:1.2rem; color:#bdbdbd;" id="profile-mail-view">dhyaneswarreddy2006@gmail.com</div>
      <button id="edit-profile-btn" style="margin-bottom:1rem; background:#4078c0; color:#fff; border:none; border-radius:8px; padding:0.5rem 1.2rem; font-weight:600; cursor:pointer;">Edit</button>
    </div>
    <form id="profile-edit-form" style="display:none; flex-direction:column; align-items:center; gap:0.7rem;">
      <input type="text" id="edit-name" placeholder="Name" style="width:90%; padding:0.5rem; border-radius:6px; border:1px solid #555;">
      <input type="email" id="edit-mail" placeholder="Email" style="width:90%; padding:0.5rem; border-radius:6px; border:1px solid #555;">
      <input type="text" id="edit-phone" placeholder="Phone" style="width:90%; padding:0.5rem; border-radius:6px; border:1px solid #555;">
      <input type="text" id="edit-skills" placeholder="Skills" style="width:90%; padding:0.5rem; border-radius:6px; border:1px solid #555;">
      <input type="text" id="edit-interests" placeholder="Interests" style="width:90%; padding:0.5rem; border-radius:6px; border:1px solid #555;">
      <div style="display:flex; gap:1rem; margin-top:0.5rem;">
        <button type="submit" style="background:#4078c0; color:#fff; border:none; border-radius:8px; padding:0.5rem 1.2rem; font-weight:600; cursor:pointer;">Save</button>
        <button type="button" id="cancel-edit-btn" style="background:#23232b; color:#fff; border:none; border-radius:8px; padding:0.5rem 1.2rem; font-weight:600; cursor:pointer;">Cancel</button>
      </div>
    </form>
    <button id="close-profile-modal" style="position:absolute; top:1rem; right:1rem; background:none; border:none; font-size:1.5rem; color:#fff; cursor:pointer;">&times;</button>
    <div style="margin-bottom:0.5rem; margin-top:0.5rem;"><b>Phone:</b> <span id="profile-phone" style="color:#bdbdbd;">8939364361</span></div>
    <div style="margin-bottom:0.5rem;"><b>Skills:</b> <span id="profile-skills" style="color:#bdbdbd;">Leadership, Coding</span></div>
    <div style="margin-bottom:0.5rem;"><b>Interests:</b> <span id="profile-interests" style="color:#bdbdbd;">Music, Sports</span></div>
  </div>
  <script>
    // Profile edit logic
    const editBtn = document.getElementById('edit-profile-btn');
    const profileView = document.getElementById('profile-view');
    const profileEditForm = document.getElementById('profile-edit-form');
    const cancelEditBtn = document.getElementById('cancel-edit-btn');
    const profileNameView = document.getElementById('profile-name-view');
    const profileMailView = document.getElementById('profile-mail-view');
    const profilePhone = document.getElementById('profile-phone');
    const profileSkills = document.getElementById('profile-skills');
    const profileInterests = document.getElementById('profile-interests');
    editBtn.addEventListener('click', function() {
      profileView.style.display = 'none';
      profileEditForm.style.display = 'flex';
      document.getElementById('edit-name').value = profileNameView.textContent;
      document.getElementById('edit-mail').value = profileMailView.textContent;
      document.getElementById('edit-phone').value = profilePhone.textContent;
      document.getElementById('edit-skills').value = profileSkills.textContent;
      document.getElementById('edit-interests').value = profileInterests.textContent;
    });
    cancelEditBtn.addEventListener('click', function() {
      profileEditForm.style.display = 'none';
      profileView.style.display = 'flex';
    });
    profileEditForm.addEventListener('submit', function(e) {
      e.preventDefault();
      profileNameView.textContent = document.getElementById('edit-name').value;
      profileMailView.textContent = document.getElementById('edit-mail').value;
      profilePhone.textContent = document.getElementById('edit-phone').value;
      profileSkills.textContent = document.getElementById('edit-skills').value;
      profileInterests.textContent = document.getElementById('edit-interests').value;
      profileEditForm.style.display = 'none';
      profileView.style.display = 'flex';
    });
    // Set default profile icon if image not found
    const profileIcon = document.getElementById('nav-profile-icon');
    profileIcon.onerror = function() {
      this.src = 'https://ui-avatars.com/api/?background=4078c0&color=fff&name=User';
    };
    // Show profile popup card below icon, outside navbar
    const profileLink = document.getElementById('profile-icon-link');
    const profileModal = document.getElementById('profile-modal');
    const closeProfileModal = document.getElementById('close-profile-modal');
    profileLink.addEventListener('click', function(e) {
      e.preventDefault();
      profileModal.style.display = 'block';
    });
    closeProfileModal.addEventListener('click', function() {
      profileModal.style.display = 'none';
    });
    document.addEventListener('click', function(e) {
      if (profileModal.style.display === 'block' && !profileModal.contains(e.target) && e.target !== profileLink && e.target !== profileIcon) {
        profileModal.style.display = 'none';
      }
    });
  </script>
  <nav class="topnav">
  <a href="dashboard.html">Dashboard</a>
  <a href="achievements.html">Achievements</a>
  <a href="add-activity.html">Add Activity</a>
  </nav>
  <!-- Dashboard Summary Section -->
  <div style="display:flex; justify-content:flex-end; max-width:900px; margin:32px auto 0 auto;">
    <a href="login.html" style="background:#4078c0; color:#fff; padding:0.5rem 1.2rem; border-radius:8px; font-weight:600; text-decoration:none; box-shadow:0 2px 8px rgba(80,80,180,0.10);">Home</a>
  </div>
  <div id="dashboard-summary" style="max-width:900px; margin:48px auto 0 auto;">
    <div style="display:flex; gap:2rem; justify-content:center; margin-bottom:2.5rem;">
      <div class="stat-card" style="background:#4078c0; color:#fff; border-radius:14px; padding:1.2rem 2.2rem; min-width:160px; text-align:center; box-shadow:0 2px 8px rgba(80,80,180,0.10);">
        <div style="font-size:2.2rem; font-weight:700;" id="total-activities">0</div>
        <div style="font-size:1.1rem;">Total Activities</div>
      </div>
      <div class="stat-card" style="background:#00b894; color:#fff; border-radius:14px; padding:1.2rem 2.2rem; min-width:160px; text-align:center; box-shadow:0 2px 8px rgba(80,80,180,0.10);">
        <div style="font-size:2.2rem; font-weight:700;" id="approved-activities">0</div>
        <div style="font-size:1.1rem;">Approved</div>
      </div>
      <div class="stat-card" style="background:#fdcb6e; color:#23232b; border-radius:14px; padding:1.2rem 2.2rem; min-width:160px; text-align:center; box-shadow:0 2px 8px rgba(80,80,180,0.10);">
        <div style="font-size:2.2rem; font-weight:700;" id="pending-activities">0</div>
        <div style="font-size:1.1rem;">Pending</div>
      </div>
        <div style="background:#fff; border-radius:14px; box-shadow:0 2px 8px rgba(80,80,180,0.10); padding:1.2rem 2.2rem; min-width:260px; text-align:center; display:flex; flex-direction:column; align-items:center;">
          <div style="font-size:1.1rem; margin-bottom:0.7rem;">Activity Status</div>
          <canvas id="activityPieChart" width="180" height="180"></canvas>
        </div>
    </div>
    <div style="display:flex; gap:2rem; flex-wrap:wrap; justify-content:center; align-items:flex-start;">
      <div style="flex:1; min-width:320px; max-width:420px; background:#fff; border-radius:14px; box-shadow:0 2px 8px rgba(80,80,180,0.10); padding:1.5rem;">
        <div style="font-weight:700; font-size:1.15rem; margin-bottom:1rem;">Activities by Category</div>
        <canvas id="activities-chart" width="350" height="220" style="margin:auto; display:block;"></canvas>
      </div>
      <div style="flex:1; min-width:320px; max-width:420px; background:#fff; border-radius:14px; box-shadow:0 2px 8px rgba(80,80,180,0.10); padding:1.5rem;">
        <div style="font-weight:700; font-size:1.15rem; margin-bottom:1rem;">Recent Activities</div>
        <ul id="recent-activities-list" style="list-style:none; padding:0; margin:0;"></ul>
      </div>
    </div>
  </div>
  <script src="dashboard.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
      function renderActivityPieChart() {
        var approved = parseInt(document.getElementById('approved-activities').textContent) || 0;
        var pending = parseInt(document.getElementById('pending-activities').textContent) || 0;
        var total = parseInt(document.getElementById('total-activities').textContent) || 0;
        var rejected = total - approved - pending;
        var ctx = document.getElementById('activityPieChart').getContext('2d');
        if (window.activityPieChart) window.activityPieChart.destroy();
        window.activityPieChart = new Chart(ctx, {
          type: 'pie',
          data: {
            labels: ['Approved', 'Pending', 'Rejected'],
            datasets: [{
              data: [approved, pending, rejected > 0 ? rejected : 0],
              backgroundColor: ['#00b894', '#fdcb6e', '#d63031'],
              borderWidth: 1
            }]
          },
          options: {
            plugins: {
              legend: { display: true, position: 'bottom' }
            }
          }
        });
      }
      // Call after stats update
      setTimeout(renderActivityPieChart, 400);
    </script>
</body>
</html>
